<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <title>
    Do you know how to create a bot in Ruby? // RubyLearning Blog
  </title>

  <link href="http://gmpg.org/xfn/11" rel="profile">
<meta http-equiv="content-type" content="text/html; charset=utf-8">


<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<meta name="description" content="">
<meta name="googlebot" content="nofollow">
<meta name="keywords" content="">
<meta name="author" content="Apoorv Saxena">


  <meta property="og:title" content="Do you know how to create a bot in Ruby?" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:locale" content="en_US" />
<meta property="og:url" content="http://rubylearning.com/blog/2013/07/09/do-you-know-how-to-create-a-bot-in-ruby/" />


  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/base-min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/pure-min.css">
  
  
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/grids-responsive-min.css">
  
  

  <link rel="stylesheet" href="http://rubylearning.com/blog//css/redlounge.css">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
  <link href='//fonts.googleapis.com/css?family=Raleway:400,200,100,700,300,500,600,800' rel='stylesheet' type='text/css'>
  <link href='//fonts.googleapis.com/css?family=Libre+Baskerville:400,700,400italic' rel='stylesheet' type='text/css'>

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  <link href="" rel="alternate" type="application/rss+xml" title="RubyLearning Blog" />

    
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/styles/tomorrow-night-bright.min.css">
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>


  

  

  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', "UA-59044-10", 'auto');
  ga('send', 'pageview');
</script>

</head>

<body>
	

	<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
  <div class="header">
    

	

    <h1 class="brand-title">Ruby Learning</h1>
    <h2 class="brand-tagline">Not Just Ruby Any More!</h2>

    <nav class="nav">
      <ul class="nav-list">
        <li class="nav-item"><span class="nav-item-separator">//</span><a href="http://rubylearning.com/blog/">Home</a></li>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="http://rubylearning.com/">Hub</a></li>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="http://rubylearning.org">Online Course</a></li>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="http://satishtalim.com/">Satish</a></li>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="http://rubylearning.com/satishtalim/tutorial.html">Tutorial</a></li>
        
      </ul>
    </nav>

    

  </div>
</div>

	
	

    <div class="content pure-u-1 pure-u-md-3-4">
		<a name="top"></a>
		

		
			
		    <div id="toc" class="pure-u-1 pure-u-md-1-4">
				<small class="toc-label">Contents</small>
		   	 	<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#introduction:175040b1a52c8d26df76afbf2ef62563">Introduction</a></li>
<li><a href="#running-bitly-bot:175040b1a52c8d26df76afbf2ef62563">Running Bitly-Bot</a></li>
<li><a href="#understanding-the-working-of-bitly-bot:175040b1a52c8d26df76afbf2ef62563">Understanding the Working of Bitly-Bot</a></li>
</ul></li>
</ul>
</nav>
		    </div>
		    
	    
  		<section class="post">
            <h1 class="post-title">
              <a href="/blog/2013/07/09/do-you-know-how-to-create-a-bot-in-ruby/">Do you know how to create a bot in Ruby?</a>
            </h1>
            <h3 class="post-subtitle">
            	
            </h3>
            
            	<span class="post-date">
                	<span class="post-date-day"><sup>9</sup></span><span class="post-date-separator">/</span><span class="post-date-month">Jul</span> <span class="post-date-year">2013</span>
            	</span>
            	
            
            	
            		<span class="post-author-single">By <a class="post-author"  target="">Apoorv Saxena</a></span>
            		




            	
            

			
			
				<div class="post-categories">
				
					<a class="post-category post-category-ruby" href="http://rubylearning.com/blog//categories/ruby">ruby</a>
				
				</div>
			

			

			

            

<p>This guest post is by Apoorv Saxena. He’s a Ruby Enthusiast, and has
been coding in Ruby since 2009. In his free time, he builds hacks using
Ruby and JavaScript; latest being <a href="https://advancedsearch.in/">Advanced Search for
Facebook</a>. He likes to
<a href="https://apoorv.quora.com/">blog</a> about Sinatra, Ruby, Digital Marketing
and Programming concepts. He would love to hear from you on <a href="https://plus.google.com/102770387697474092552/about">Google
Plus</a> or through
<a href="mailto:root@apoorv.pro">mail</a>.</p>

<h2 id="introduction:175040b1a52c8d26df76afbf2ef62563">Introduction</h2>

<p><img src="http://rubylearning.com/images/apoorvsaxena.jpg" alt="Apoorv Saxena" />
 <strong>A</strong>
bot can be defined as a continuously running script that is responsible
for performing a specific task regularly or respond to an action
triggered on a specific event. Bots are targeted to perform an action
that is repetitive in nature or has a limited number of events to
respond. See the <a href="http://en.wikipedia.org/wiki/Internet_bot">Wikipedia
article</a> on bots that
describes the different types of bots built to perform a variety of
different tasks.</p>

<p>Today, we are going to create a bot that repeats a certain task after
every X mins of time. The repetitive task that we have chosen to
perform, is to get the links of the Most Trending Stories on Internet in
Real Time (using Bitly’s Social Data APIs) and display them on our
command line. Our bot will also send notification pop-ups on our screen
whenever it fetches the latest data after every X mins of time. We will
name our bot as <code>Bitly-Bot</code> as it uses Bitly’s APIs to bring us Trending
Data in Real Time.</p>

<p><a href="http://rubylearning.com/blog/media/OurBot.png"><img src="http://rubylearning.com/blog/media/OurBot.png" alt="OurBot" title="OurBot" />
</a></p>

<p>OurBot</p>

<h2 id="running-bitly-bot:175040b1a52c8d26df76afbf2ef62563">Running Bitly-Bot</h2>

<p>You can clone Bitly Bot’s Code from
<a href="https://github.com/ApoorvSaxena/Bitly-Bot">GitHub</a> for reference and
run it as well on your machine, it contains the instructions to setup
Bitly-Bot on your local machine, it also contains the links to create
Bitly Application (required to access Bitly’s Social Data APIs) and
install Growl Application on your Mac OS X (to send notification pop-ups
from Bitly-Bot).</p>

<h2 id="understanding-the-working-of-bitly-bot:175040b1a52c8d26df76afbf2ef62563">Understanding the Working of Bitly-Bot</h2>

<p>We start with the initialization of a class named <code>Bitly</code> that is
responsible for handling the API calls interaction, it sends request to
Bitly  containing our Application Generic Access token, to validate our
application and fetches the Hot and Bursting Topics data along with the
Most Trending Story links associated with these topics in JSON format.
We have used Threads to make two network API calls simultaneously to
Bitly(one to bring Hot Topics and the other to bring Bursting Topics),
instead of triggering them sequentially, thus saving us time and
patience to see our Bot’s response.</p>

<pre><code>class Bitly

  def initialize()
    @access_token = $config['access_token']
    @colorize = Colorize.new
  end

  def get_url(phrase)
    @base_url = &quot;https://api-ssl.bitly.com/v3/realtime/#{phrase}_phrases?access_token=#{@access_token}&quot;
  end

  def get_topics(phrase_types)
    threads = []
    phrase_types.each do |phrase_type|
      base_url = get_url phrase_type
      threads &lt;&lt; Thread.new(base_url, phrase_type) do |url, phrase_type|
        begin
          response = JSON.parse RestClient.get url
          if response['status_code'] != 200
            puts  @colorize.display 'Error: ' + response['status_txt'] + '\n', :error
            exit
          end
          display response,phrase_type
        rescue
          display_error_message
        end
        puts &quot;\n\n&quot;
      end
    end
    threads.each { |aThread|  aThread.join }
  end

  def display(response,phrase_type)
    puts GrowlNotifications.display &quot;#{phrase_type.capitalize} Topics&quot;
    puts @colorize.display &quot;#{phrase_type.capitalize} Topics&quot;, :heading
    response['data']['phrases'].each do |data|
      puts @colorize.display(&quot;#{data['phrase']}&quot;, :text) + &quot; &quot; + @colorize.display(&quot;http://bit.ly/#{data['ghashes'][0]['ghash']}&quot;, :link)
    end
  end

  def display_error_message
   puts @colorize.display 'Unable to connect to the Server', :error
   exit
  end

end
</code></pre>

<p>We have a class named <code>Colorize</code> which contains a method named <code>display</code>
that displays the different parts of APIs response in different colors,
while also colorizing an error message that is displayed when we are not
able to connect to Bitly. Another class named <code>GrowlNotifications</code>
simply echoes a text on the terminal that contains the code which
triggers the Growl Notifications on Mac OS X.</p>

<pre><code>class Colorize
  def display(text, element)
    color_code = case element
      when :text
        ['1;','32;','40m']
      when :heading
        ['1;','33;','40m']
      when :error
        ['1;','','31m']
      when :link
        ['4;','31;','48m']
    end
    &quot;33[#{color_code[0]}#{color_code[1]}#{color_code[2]}#{text}33[0m&quot;
  end
end  

class GrowlNotifications
  def self.display(text)
    &quot;\e]9;#{text}07&quot;
  end
end
</code></pre>

<p>Now that we have finished writing our bot script, we would like to run
it as a Daemon in a terminal window. Most processes that run as Daemon,
are run as background jobs, however, in our case, we would like to see
the Trending Topics links inside our terminal window, for which the
daemon has to run in the current terminal window in which it is started.
We specify the bot to run in our current terminal window by giving an
additional parameter <code>ontop</code> when writing the code to run our Daemon.</p>

<pre><code>Daemons.run('application.rb', {:ontop =&gt; true, :app_name =&gt; 'Bitly-Bot'})
</code></pre>

<p>Now we code our application to run continuously with a delay of X
minutes while controlling it via our Daemon process.</p>

<pre><code>loop do
  Bitly.new.get_topics ['bursting', 'hot']
  sleep $config['delay'] * 60 # delaying in minutes
end
</code></pre>

<p>That’s it! We are ready to receive Trending Story Links from our Bot
after every X mins, along with Notification Popups and Colored Output to
grab our attention.</p>

<p><em>I hope this article explains and motivates you enough to create a bot
in Ruby by yourself, and explore the amazing stuff that you can perform
with a bot at your disposal. Feel free to ask questions and give
feedback in the comments section of this post. Thanks!</em></p>

	
			

			
				<div class="tags-list">
					<span class="dark-red">Tags</span><span class="decorative-marker">//</span>
					
	                <a class="post-tag post-tag-apoorv-saxena" href="http://rubylearning.com/blog//tags/apoorv-saxena">apoorv saxena</a>,
	                
	                <a class="post-tag post-tag-bot" href="http://rubylearning.com/blog//tags/bot">bot</a>,
	                
	                <a class="post-tag post-tag-programming" href="http://rubylearning.com/blog//tags/programming">programming</a>,
	                
	                <a class="post-tag post-tag-ruby" href="http://rubylearning.com/blog//tags/ruby">ruby</a>,
	                
				</div>
			

			
				<div class="paging">
					<span class="paging-label">More Reading</span>
					
					<div class="paging-newer">
						<span class="dark-red">Newer</span><span class="decorative-marker">//</span>
						<a class="paging-link" href="/blog/how-the-course-works/">How The Course Works</a>
		            </div>
		            

					
					<div class="paging-older">
						<span class="dark-red">Older</span><span class="decorative-marker">//</span>
			            <a class="paging-link" href="/blog/2013/06/20/learn-more-about-indias-exciting-rubyconfindia-2013/">Learn More About India&#39;s Exciting RubyConfIndia 2013</a>
		            </div>
		            
	            </div>
            
          </section>
          
          	<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'rubylearning';
    var disqus_identifier = 'http:\/\/rubylearning.com\/blog\/2013\/07\/09\/do-you-know-how-to-create-a-bot-in-ruby\/';
    var disqus_title = 'Do you know how to create a bot in Ruby?';
    var disqus_url = 'http:\/\/rubylearning.com\/blog\/2013\/07\/09\/do-you-know-how-to-create-a-bot-in-ruby\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
          
        
      <div class="footer">
	<hr class="thin" />
	<div class="pure-menu pure-menu-horizontal pure-menu-open">
		<ul class="footer-menu">
		
		</ul>
	</div>

	<p>&copy; 2015 RubyLearning. All rights reserved. </p>
</div>

    </div>
  </div>
	

	

  
</body>
</html>
