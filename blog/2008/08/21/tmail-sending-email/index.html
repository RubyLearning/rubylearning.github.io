<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <title>
    TMail: Sending email // RubyLearning Blog
  </title>

  <link href="http://gmpg.org/xfn/11" rel="profile">
<meta http-equiv="content-type" content="text/html; charset=utf-8">


<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<meta name="description" content="">
<meta name="googlebot" content="nofollow">
<meta name="keywords" content="">
<meta name="author" content="Satish Talim">


  <meta property="og:title" content="TMail: Sending email" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:locale" content="en_US" />
<meta property="og:url" content="http://rubylearning.com/blog/2008/08/21/tmail-sending-email/" />


  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/base-min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/pure-min.css">
  
  
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/grids-responsive-min.css">
  
  

  <link rel="stylesheet" href="http://rubylearning.com/blog//css/redlounge.css">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
  <link href='//fonts.googleapis.com/css?family=Raleway:400,200,100,700,300,500,600,800' rel='stylesheet' type='text/css'>
  <link href='//fonts.googleapis.com/css?family=Libre+Baskerville:400,700,400italic' rel='stylesheet' type='text/css'>

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  <link href="" rel="alternate" type="application/rss+xml" title="RubyLearning Blog" />

    
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/styles/tomorrow-night-bright.min.css">
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>


  

  

  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', "UA-59044-10", 'auto');
  ga('send', 'pageview');
</script>

</head>

<body>
	

	<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
  <div class="header">
    

	

    <h1 class="brand-title">Ruby Learning</h1>
    <h2 class="brand-tagline">Not Just Ruby Any More!</h2>

    <nav class="nav">
      <ul class="nav-list">
        <li class="nav-item"><span class="nav-item-separator">//</span><a href="http://rubylearning.com/blog/">Home</a></li>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="http://rubylearning.com/">Hub</a></li>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="http://rubylearning.org">Online Course</a></li>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="http://satishtalim.com/">Satish</a></li>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="http://rubylearning.com/satishtalim/tutorial.html">Tutorial</a></li>
        
      </ul>
    </nav>

    

  </div>
</div>

	
	

    <div class="content pure-u-1 pure-u-md-3-4">
		<a name="top"></a>
		

		
			
	    
  		<section class="post">
            <h1 class="post-title">
              <a href="/blog/2008/08/21/tmail-sending-email/">TMail: Sending email</a>
            </h1>
            <h3 class="post-subtitle">
            	
            </h3>
            
            	<span class="post-date">
                	<span class="post-date-day"><sup>21</sup></span><span class="post-date-separator">/</span><span class="post-date-month">Aug</span> <span class="post-date-year">2008</span>
            	</span>
            	
            
            	
            		<span class="post-author-single">By <a class="post-author"  target="">Satish Talim</a></span>
            		




            	
            

			
			
				<div class="post-categories">
				
					<a class="post-category post-category-code-snippets" href="http://rubylearning.com/blog//categories/code-snippets">Code Snippets</a>
				
					<a class="post-category post-category-ruby" href="http://rubylearning.com/blog//categories/ruby">Ruby</a>
				
					<a class="post-category post-category-training" href="http://rubylearning.com/blog//categories/training">Training</a>
				
				</div>
			

			

			

            <div>
  <blockquote class="right">
    <p>
      TMail is a commonly used library by the ActionMailer component of Ruby
    </p>
  </blockquote>
  
  <p>
    <span class="drop_cap">T</span>he students of the <a href="http://rubylearning.org/class/">FORPC101</a> batch wanted to know how they could <strong>send an email in Ruby</strong>. Today, out of the various options available, we will have a quick look at <strong><a href="http://tmail.rubyforge.org/index.html">TMail</a></strong> &#8211; a library used for composing and manipulating email messages for Ruby.
  </p>
  
  <p class="note">
    <em><strong>TMail</strong> is designed to be an Request For Comments (RFC) compatible library. The goal of TMail is to allow you to create emails programatically without having to know about the RFCs or how they work, or what their standards are</em>.
  </p>
  
  <h3>
    Installation
  </h3>
  
  <p>
    On a Windows box, we can install the TMail gem as follows:
  </p>
  
  <pre><code>c:\>gem install tmail</code></pre>
  
  <h3>
    Sending an email
  </h3>
  
  <p>
    You first put at the top of your class:
  </p>
  
  <pre><code>require 'tmail'</code></pre>
  
  <p>
    Accessing a TMail object is done via the <strong>TMail::Mail</strong> class. As email can be fairly complex creatures, you will find a large amount of accessor and setter methods in this class!
  </p>
  
  <p>
    You then create an empty mail object by calling <strong>TMail::Mail.new</strong>. This creates a completely blank email message. To be a valid email message, you&#8217;ll need to modify the headers by simply accessing them using the accessor methods. Some of the public instance methods we use are: from, to, subject, date and body (for full details, please refer to the <a href="http://tmail.rubyforge.org/rdoc/index.html">TMail documentation</a>). For example, the documentation for the instance method subject is:<br /><strong>subject( default = nil )</strong><br />Returns the subject of the mail instance. If the subject field does not exist, returns nil by default or you can pass in as the parameter for what you want the default value to be. Example:
  </p>
  
  <pre><code>mail = TMail::Mail.new
mail.subject #=> nil
mail.subject("") #=> ""
mail.subject = "Hello"
mail.subject #=> "Hello"</code></pre>
  
  <p>
    Once the email message is created, you can call the to_s method to convert it back into a string. Then it can be sent with the <strong><a href="http://www.ruby-doc.org/stdlib/libdoc/net/smtp/rdoc/index.html">Net::SMTP</a></strong> library. The Net::SMTP library provides functionality to send internet mail via SMTP, the Simple Mail Transfer Protocol. The Net::SMTP.start method creates a new Net::SMTP object, opens a TCP connection and connects to the server. &#8216;localhost&#8217; is the IP address of your SMTP server and the port used is 25. Since we have called with a block, the newly-opened Net::SMTP object is yielded to the block, and automatically closed when the block finishes.
  </p>
  
  <p>
    Before you run the program (full code below), you need to start the SMTP server. On Windows, I prefer to download and use the <a href="http://www.softstack.com/freesmtp.html">Free SMTP Server</a> for testing. Connect your PC to the Internet, then start the Free SMTP Server program. The program will try to detect your provider&#8217;s DNS server. If a DNS server is available and the standard SMTP port #25 is free, the program will become ready to process your mail. If it is not possible to detect provider&#8217;s DNS server, the program will prompt you to enter any DNS server you know, after that if the server exists the program will become ready to process mail. If the port #25 is busy by another local SMTP server/service, the program will show you an error message. You can specify any DNS server or SMTP port by using the button Options, which is situated on the Toolbar. You should use the word &#8220;localhost&#8221; as the SMTP server host in your mail program.
  </p>
  
  <p>
    Here&#8217;s the complete program code:
  </p>
  
  <pre><code>require 'rubygems'
require 'tmail'
require 'net/smtp'

tomail = 'satishtalim@gmail.com'
frommail = 'superman@world.com'
mail = TMail::Mail.new
mail.to = tomail
mail.from = frommail
mail.subject = 'Test message'
mail.date = Time.now
mail.body = 'Thanks to Locaweb for making this possible.'


Net::SMTP.start( 'localhost', 25 ) do|smtpclient|
  smtpclient.send_message(
    mail.to_s,
    frommail,
    tomail
  )
end</code></pre>
  
  <p>
    It is to be noted that TMail is a commonly used library by the ActionMailer component of Ruby on Rails, the Nitro web framework, the Ruby-Talk mail gateway and many others.
  </p>
</div>

<p>Technorati Tags: <a href="http://technorati.com/tag/ActionMailer" rel="tag">ActionMailer</a>, <a href="http://technorati.com/tag/Ruby" rel="tag">Ruby</a>, <a href="http://technorati.com/tag/Sending+Email" rel="tag">Sending Email</a>, <a href="http://technorati.com/tag/TMail" rel="tag">TMail</a></p>

	
			

			
				<div class="tags-list">
					<span class="dark-red">Tags</span><span class="decorative-marker">//</span>
					
	                <a class="post-tag post-tag-actionmailer" href="http://rubylearning.com/blog//tags/actionmailer">ActionMailer</a>,
	                
	                <a class="post-tag post-tag-email" href="http://rubylearning.com/blog//tags/email">email</a>,
	                
	                <a class="post-tag post-tag-programming" href="http://rubylearning.com/blog//tags/programming">programming</a>,
	                
	                <a class="post-tag post-tag-ruby" href="http://rubylearning.com/blog//tags/ruby">Ruby</a>,
	                
	                <a class="post-tag post-tag-ruby-programming" href="http://rubylearning.com/blog//tags/ruby-programming">ruby programming</a>,
	                
	                <a class="post-tag post-tag-tmail" href="http://rubylearning.com/blog//tags/tmail">TMail</a>,
	                
				</div>
			

			
				<div class="paging">
					<span class="paging-label">More Reading</span>
					
					<div class="paging-newer">
						<span class="dark-red">Newer</span><span class="decorative-marker">//</span>
						<a class="paging-link" href="/blog/2008/08/26/which-21-topics-would-you-suggest-for-an-advanced-ruby-course-and-why/">Which 21 topics would YOU suggest for an Advanced Ruby Course and why?</a>
		            </div>
		            

					
					<div class="paging-older">
						<span class="dark-red">Older</span><span class="decorative-marker">//</span>
			            <a class="paging-link" href="/blog/2008/08/06/thanks-to-rubylearning-sponsor-peepcode/">Thanks to RubyLearning Sponsor PeepCode</a>
		            </div>
		            
	            </div>
            
          </section>
          
          	<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'rubylearning';
    var disqus_identifier = 'http:\/\/rubylearning.com\/blog\/2008\/08\/21\/tmail-sending-email\/';
    var disqus_title = 'TMail: Sending email';
    var disqus_url = 'http:\/\/rubylearning.com\/blog\/2008\/08\/21\/tmail-sending-email\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
          
        
      <div class="footer">
	<hr class="thin" />
	<div class="pure-menu pure-menu-horizontal pure-menu-open">
		<ul class="footer-menu">
		
		</ul>
	</div>

	<p>&copy; 2015 RubyLearning. All rights reserved. </p>
</div>

    </div>
  </div>
	

	

  
</body>
</html>
